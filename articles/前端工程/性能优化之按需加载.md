# 性能优化之按需加载

## 前言

`性能优化` 是每一个工程师都绕不开的话题，也是企业考察工程师专业程度的指标之一。本文将带你深入了解 `按需加载`，希望对大家有所帮助。

## 定义

按需加载，顾名思义，需要什么加载什么，避免 `过度` 加载模块。这样可以减少代码的体积，从而提升性能。

## TreeShaking

## ElementUI

从官网的教程来看，ElementUI能够按需加载，离不开 [babel-plugin-component](https://github.com/ElementUI/babel-plugin-component) 的作用。

具体的使用方式，请移步[这里](https://element.eleme.cn/#/zh-CN/component/quickstart)。

### 原理

我们先来看看ElementUI包含的内容：

    ElementUI
        |
        |---- package.json
        |          |
        |          |----- "main": "lib/element-ui.common.js"
        |          |----- ...
        |          
        |----- lib
                |
                |---- directives
                |
                |---- locale
                |
                |---- ... 其他工具函数
                |
                |---- alert.js alert组件
                |
                |---- aside.js aside组件
                |
                |---- ... 其他组件脚本
                |
                |---- element-ui.common.js
                |
                |---- index.js

**结论**

1. 从 `pkg` 可以看出，模块的入口文件为 `element-ui.common.js`；

2. 除了index.js，其他模块采用都是 `commonjs` 的模块方案；

3. 组件被编译成单个的js文件，项目中单独引入也是可以正常使用的。如下：

```vue
    import Button from 'element-ui/lib/button';
    Vue.component(Button.name, Button);
    new Vue({
        render: (h) => h({
            render: h => h('el-button', 'hello world')
        }),
    }).$mount("#app");
```

4. element-ui.common.js组件包含了所有组件的代码，以及通过commonjs加载工具库模块。
           
我们每次引入 element-ui.common.js，babel-plugin-component是如何过滤掉未被使用的模块呢？我们继续来深入学习。



## lodash







